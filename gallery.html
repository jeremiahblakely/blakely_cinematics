<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client Gallery - Blakely Cinematics</title>
    <meta name="description" content="Private client gallery for Blakely Cinematics">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/styles.css">
    
    <!-- AWS CloudWatch RUM Analytics -->
    <script>
      (function(n,i,v,r,s,c,x,z){x=window.AwsRumClient={q:[],n:i,i:i,v:v,r:r,c:c};window[n]=function(c,p){x.q.push({c:c,p:p});};z=document.createElement('script');z.async=true;z.src=s;document.head.insertBefore(z,document.head.getElementsByTagName('script')[0]);})(
        'cwr',
        '1a163e06-eb6a-4131-bdb1-6e27fbb0799c',
        '1.0.0',
        'us-east-1',
        'https://client.rum.us-east-1.amazonaws.com/1.19.0/cwr.js',
        {
          sessionSampleRate: 1 ,
          endpoint: "https://dataplane.rum.us-east-1.amazonaws.com" ,
          telemetries: ["performance","errors","http"] ,
          allowCookies: true ,
          enableXRay: false ,
          signing: true
        }
      );
    </script>
</head>
<body class="gallery-page">
    <!-- Custom Cursor -->
    <div class="cursor"></div>
    <div class="cursor-follower"></div>
    
    <!-- Minimal Navigation -->
    <nav class="gallery-nav">
        <div class="nav-container">
            <a href="index.html" class="logo">BLAKELY</a>
            <a href="vip.html" class="sign-out-link">Sign Out</a>
        </div>
    </nav>
    
    <!-- Gallery Header -->
    <section class="gallery-header">
        <div class="gallery-header-content">
            <div class="client-info">
                <h1 class="client-name">Sarah Johnson - Headshots</h1>
                <div class="session-details">
                    <span class="session-date">August 2025</span>
                    <span class="image-count">24 images available</span>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Gallery Actions -->
    <section class="gallery-actions">
        <div class="actions-container">
            <div class="selection-controls">
                <button class="action-btn select-all-btn">Select All</button>
                <button class="action-btn clear-selection-btn">Clear Selection</button>
                <span class="selected-count">0 selected</span>
            </div>
            
            <div class="download-controls">
                <button class="download-btn btn btn-primary" disabled>
                    Download Selected
                </button>
            </div>
        </div>
    </section>
    
    <!-- Photo Gallery Grid -->
    <section class="photo-gallery">
        <div class="gallery-grid" id="gallery-grid">
            <!-- Placeholder images - will be generated by JavaScript -->
        </div>
    </section>
    
    <!-- Gallery Footer -->
    <footer class="gallery-footer">
        <div class="footer-container">
            <p>&copy; 2024 Blakely Cinematics. All rights reserved. | Private gallery for authorized clients only.</p>
        </div>
    </footer>
    
    <!-- JavaScript -->
    <script>
        // Gallery functionality
        class ClientGallery {
            constructor() {
                this.selectedImages = new Set();
                this.totalImages = 12; // For demo purposes
                this.galleryInfo = null;
                this.init();
            }
            
            init() {
                // Check authentication first
                if (!this.checkAuthentication()) {
                    return; // Will redirect, so don't continue initialization
                }
                
                this.loadGalleryInfo();
                this.createImageGrid();
                this.bindEvents();
                this.updateSelectedCount();
            }
            
            checkAuthentication() {
                const isAuthenticated = sessionStorage.getItem('authenticated');
                if (!isAuthenticated || isAuthenticated !== 'true') {
                    console.log('ðŸš« Not authenticated - redirecting to VIP login');
                    window.location.href = 'vip.html';
                    return false;
                }
                return true;
            }
            
            loadGalleryInfo() {
                const galleryInfoStr = sessionStorage.getItem('galleryInfo');
                if (galleryInfoStr) {
                    this.galleryInfo = JSON.parse(galleryInfoStr);
                    console.log('ðŸ“‹ Gallery info loaded:', this.galleryInfo);
                    this.displayClientInfo();
                }
            }
            
            displayClientInfo() {
                if (this.galleryInfo) {
                    // Update client name and session type
                    const clientNameEl = document.querySelector('.client-name');
                    if (clientNameEl) {
                        clientNameEl.textContent = `${this.galleryInfo.clientName} - ${this.galleryInfo.sessionType}`;
                    }
                    
                    // Update session date if available
                    const sessionDateEl = document.querySelector('.session-date');
                    if (sessionDateEl && this.galleryInfo.sessionDate) {
                        sessionDateEl.textContent = this.galleryInfo.sessionDate;
                    }
                    
                    // Update image count if available
                    const imageCountEl = document.querySelector('.image-count');
                    if (imageCountEl && this.galleryInfo.imageCount) {
                        this.totalImages = this.galleryInfo.imageCount;
                        imageCountEl.textContent = `${this.totalImages} images available`;
                    }
                }
            }
            
            createImageGrid() {
                const grid = document.getElementById('gallery-grid');
                
                for (let i = 1; i <= this.totalImages; i++) {
                    const imageBox = document.createElement('div');
                    imageBox.className = 'gallery-image';
                    imageBox.dataset.imageId = `IMG-${String(i).padStart(3, '0')}`;
                    
                    imageBox.innerHTML = `
                        <div class="image-placeholder">
                            <div class="image-overlay">
                                <span class="image-number">IMG-${String(i).padStart(3, '0')}</span>
                            </div>
                            <input type="checkbox" class="image-checkbox" id="img-${i}">
                            <label for="img-${i}" class="checkbox-label"></label>
                        </div>
                    `;
                    
                    grid.appendChild(imageBox);
                }
            }
            
            bindEvents() {
                // Individual image selection
                document.addEventListener('change', (e) => {
                    if (e.target.classList.contains('image-checkbox')) {
                        this.toggleImageSelection(e.target);
                    }
                });
                
                // Select all button
                document.querySelector('.select-all-btn').addEventListener('click', () => {
                    this.selectAll();
                });
                
                // Clear selection button
                document.querySelector('.clear-selection-btn').addEventListener('click', () => {
                    this.clearSelection();
                });
                
                // Download button
                document.querySelector('.download-btn').addEventListener('click', () => {
                    this.downloadSelected();
                });
            }
            
            toggleImageSelection(checkbox) {
                const imageId = checkbox.id.replace('img-', '');
                const imageBox = checkbox.closest('.gallery-image');
                
                if (checkbox.checked) {
                    this.selectedImages.add(imageId);
                    imageBox.classList.add('selected');
                    console.log(`Selected: IMG-${String(imageId).padStart(3, '0')}`);
                } else {
                    this.selectedImages.delete(imageId);
                    imageBox.classList.remove('selected');
                    console.log(`Deselected: IMG-${String(imageId).padStart(3, '0')}`);
                }
                
                this.updateSelectedCount();
            }
            
            selectAll() {
                const checkboxes = document.querySelectorAll('.image-checkbox');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = true;
                    const imageId = checkbox.id.replace('img-', '');
                    this.selectedImages.add(imageId);
                    checkbox.closest('.gallery-image').classList.add('selected');
                });
                
                this.updateSelectedCount();
                console.log('Selected all images');
            }
            
            clearSelection() {
                const checkboxes = document.querySelectorAll('.image-checkbox');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                    checkbox.closest('.gallery-image').classList.remove('selected');
                });
                
                this.selectedImages.clear();
                this.updateSelectedCount();
                console.log('Cleared all selections');
            }
            
            updateSelectedCount() {
                const count = this.selectedImages.size;
                const countElement = document.querySelector('.selected-count');
                const downloadBtn = document.querySelector('.download-btn');
                
                countElement.textContent = `${count} selected`;
                
                if (count > 0) {
                    downloadBtn.disabled = false;
                    downloadBtn.textContent = `Download Selected (${count})`;
                } else {
                    downloadBtn.disabled = true;
                    downloadBtn.textContent = 'Download Selected';
                }
            }
            
            downloadSelected() {
                if (this.selectedImages.size === 0) {
                    alert('Please select images to download');
                    return;
                }
                
                const selectedList = Array.from(this.selectedImages).map(id => 
                    `IMG-${String(id).padStart(3, '0')}`
                );
                
                console.log('ðŸ”½ Download request for:', selectedList);
                alert(`Download request sent for ${this.selectedImages.size} images. You will receive a download link via email shortly.`);
            }
        }
        
        // Sign out functionality
        function handleSignOut() {
            console.log('ðŸšª Signing out - clearing session storage');
            sessionStorage.removeItem('authenticated');
            sessionStorage.removeItem('galleryInfo');
            window.location.href = 'vip.html';
        }
        
        // Initialize gallery when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize custom cursor and other components
            if (typeof initCustomCursor === 'function') {
                initCustomCursor();
            }
            
            // Bind sign out event
            const signOutLink = document.querySelector('.sign-out-link');
            if (signOutLink) {
                signOutLink.addEventListener('click', function(e) {
                    e.preventDefault();
                    handleSignOut();
                });
            }
            
            // Initialize gallery
            new ClientGallery();
        });
    </script>
    
    <!-- Load main script for shared functionality -->
    <script src="js/script.js"></script>
</body>
</html>